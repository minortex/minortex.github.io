+++
date = '2025-09-19T19:13:57+08:00'
draft = true
title = 'cpp学习笔记（2）'
+++
## 符号变量

magic number这个词，我一直认为是大家约定好了的一组数，但是这里是不同的含义。

它指的是直接放在函数里面，没有任何交代的数据，使得程序更加难读。

所以做法一般是推荐用`const`修饰，如果标准高的话，`constexpr`，请。

## 字符串

从c开始那么久，都一直没认真了解过字符串，这会终于明白了`std::string`的一些基本操作。

众所周知，字符串里面不可避免包含空白字符，那么办法就是通过`std::getline()`，但是如果在`std::cin`之后使用，大概率这么传入`(std::cin, target)`是无效的，因为`cin`在读到空白字符之后会停止，并且把空白字符留在缓冲区，那么下一次读取的时候，直接就把一个`\n`传入了，所以你的字符串啥都没有。

问题解决是通过流操纵符`std::ws`（这个需要每次cin的时候都提供），控制如果一开始就读取到空白字符，那么就忽略掉这个字符继续读取后面的东西。

这时就很好的解决了读取到`\n`的问题，除非读取到下一个`\n`，那么`getline`才停止读取，此时字符串也成功存入了这一行。

怎么说呢，感觉比c先进一点点（？

## string_view

```cpp
// 用string_view指向string的话，不产生多余的拷贝，只是在初始化的时候拷贝进入string
std::string name {"John"}; //此处产生拷贝
std::string_view name_v {name}; // 不拷贝

// 实际上，是让string_view指向一个c风格的字符串，这个过程没有拷贝。
std::string_view name {"John"};
```
如果常量能够在编译时确定，那么就可以应用`constexpr`。很显然，前者是不可行的，后者可以。

---

> ⚠️ string_view的行为与普通的引用和指针不一致。


当用`string`来初始化`string_view`，然后`string`被修改之后，`string_view`并不会更新`string`的新长度。

如果要避免，得更新视图。（不知道智能指针是否有帮助？）

---

不建议用`string_view`来返回，除非它是用C式的字符串初始化的。
